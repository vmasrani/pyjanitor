
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pivot_Longer : One function to cover transformations from wide to long form. &#8212; pyjanitor  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples" href="README.html" />
    <link rel="prev" title="pyjanitor Usage Walkthrough" href="pyjanitor_intro.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Pivot_Longer-:-One-function-to-cover-transformations-from-wide-to-long-form.">
<h1>Pivot_Longer : One function to cover transformations from wide to long form.<a class="headerlink" href="#Pivot_Longer-:-One-function-to-cover-transformations-from-wide-to-long-form." title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">janitor</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<p>Unpivoting(reshaping data from wide to long form) in Pandas is executed either through <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.melt.html">pd.melt</a>, <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">pd.wide_to_long</a>, or <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.stack.html">pd.stack</a>. However, there are scenarios where a few more steps are required to massage the data into the long form that we desire.
Take the dataframe below, copied from <a class="reference external" href="https://stackoverflow.com/questions/64061588/pandas-melt-multiple-columns-to-tabulate-a-dataset#64062002">Stack Overflow</a>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="s2">&quot;M_start_date_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">201709</span><span class="p">,</span> <span class="mi">201709</span><span class="p">,</span> <span class="mi">201709</span><span class="p">],</span>
            <span class="s2">&quot;M_end_date_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">201905</span><span class="p">,</span> <span class="mi">201905</span><span class="p">,</span> <span class="mi">201905</span><span class="p">],</span>
            <span class="s2">&quot;M_start_date_2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">202004</span><span class="p">,</span> <span class="mi">202004</span><span class="p">,</span> <span class="mi">202004</span><span class="p">],</span>
            <span class="s2">&quot;M_end_date_2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">202005</span><span class="p">,</span> <span class="mi">202005</span><span class="p">,</span> <span class="mi">202005</span><span class="p">],</span>
            <span class="s2">&quot;F_start_date_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">201803</span><span class="p">,</span> <span class="mi">201803</span><span class="p">,</span> <span class="mi">201803</span><span class="p">],</span>
            <span class="s2">&quot;F_end_date_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">201904</span><span class="p">,</span> <span class="mi">201904</span><span class="p">,</span> <span class="mi">201904</span><span class="p">],</span>
            <span class="s2">&quot;F_start_date_2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">201912</span><span class="p">,</span> <span class="mi">201912</span><span class="p">,</span> <span class="mi">201912</span><span class="p">],</span>
            <span class="s2">&quot;F_end_date_2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">202007</span><span class="p">,</span> <span class="mi">202007</span><span class="p">,</span> <span class="mi">202007</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>M_start_date_1</th>
      <th>M_end_date_1</th>
      <th>M_start_date_2</th>
      <th>M_end_date_2</th>
      <th>F_start_date_1</th>
      <th>F_end_date_1</th>
      <th>F_start_date_2</th>
      <th>F_end_date_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>201709</td>
      <td>201905</td>
      <td>202004</td>
      <td>202005</td>
      <td>201803</td>
      <td>201904</td>
      <td>201912</td>
      <td>202007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>201709</td>
      <td>201905</td>
      <td>202004</td>
      <td>202005</td>
      <td>201803</td>
      <td>201904</td>
      <td>201912</td>
      <td>202007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>201709</td>
      <td>201905</td>
      <td>202004</td>
      <td>202005</td>
      <td>201803</td>
      <td>201904</td>
      <td>201912</td>
      <td>202007</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Below is a <a class="reference external" href="https://stackoverflow.com/a/64062027/7175713">beautiful solution</a>, from Stack Overflow :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
<span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
          <span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
          <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
          <span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
          <span class="o">.</span><span class="n">rename_axis</span><span class="p">([</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;cod&#39;</span><span class="p">])</span>
          <span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>

<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>cod</th>
      <th>start</th>
      <th>end</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>M</td>
      <td>201709</td>
      <td>201905</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>M</td>
      <td>202004</td>
      <td>202005</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>F</td>
      <td>201803</td>
      <td>201904</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>F</td>
      <td>201912</td>
      <td>202007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>M</td>
      <td>201709</td>
      <td>201905</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>M</td>
      <td>202004</td>
      <td>202005</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>F</td>
      <td>201803</td>
      <td>201904</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>F</td>
      <td>201912</td>
      <td>202007</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>M</td>
      <td>201709</td>
      <td>201905</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3</td>
      <td>M</td>
      <td>202004</td>
      <td>202005</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3</td>
      <td>F</td>
      <td>201803</td>
      <td>201904</td>
    </tr>
    <tr>
      <th>11</th>
      <td>3</td>
      <td>F</td>
      <td>201912</td>
      <td>202007</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We propose an alternative, based on <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.melt.html">pandas melt</a>, that abstracts the reshaping mechanism, allows the user to focus on the task, can be applied to other scenarios, and is chainable :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span>
        <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;cod&quot;</span><span class="p">,</span> <span class="s2">&quot;.value&quot;</span><span class="p">),</span>
        <span class="n">names_pattern</span><span class="o">=</span><span class="s2">&quot;(M|F)_(start|end)_.+&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>cod</th>
      <th>start</th>
      <th>end</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>M</td>
      <td>201709</td>
      <td>201905</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>M</td>
      <td>202004</td>
      <td>202005</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>F</td>
      <td>201803</td>
      <td>201904</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>F</td>
      <td>201912</td>
      <td>202007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>M</td>
      <td>201709</td>
      <td>201905</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>M</td>
      <td>202004</td>
      <td>202005</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>F</td>
      <td>201803</td>
      <td>201904</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>F</td>
      <td>201912</td>
      <td>202007</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>M</td>
      <td>201709</td>
      <td>201905</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3</td>
      <td>M</td>
      <td>202004</td>
      <td>202005</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3</td>
      <td>F</td>
      <td>201803</td>
      <td>201904</td>
    </tr>
    <tr>
      <th>11</th>
      <td>3</td>
      <td>F</td>
      <td>201912</td>
      <td>202007</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> is not a new idea; it is a combination of ideas from Râs <a class="reference external" href="https://tidyr.tidyverse.org/reference/pivot_longer.html">tidyr</a> and Râs <a class="reference external" href="https://rdatatable.gitlab.io/data.table/">data.table</a> and is built on the powerful <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.melt.html">pd.melt</a>.</p>
<p>Do note that the <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> function is designed primarily to work with single indexed dataframes; for MultiIndex dataframes, <code class="docutils literal notranslate"><span class="pre">pandas_melt</span></code> is more than adequate.</p>
<p><code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> can melt dataframes easily; it is just a wrapper around <code class="docutils literal notranslate"><span class="pre">pd.melt</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">},</span>
                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
                   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">6</span><span class="p">}})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>B</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>B</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c</td>
      <td>B</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>You can dynamically select columns, using regular expressions with the <code class="docutils literal notranslate"><span class="pre">janitor.patterns</span></code> function (inspired by Râs data.tableâs <a class="reference external" href="https://rdatatable.gitlab.io/data.table/reference/patterns.html">patterns</a> function, and is really just a wrapper around <code class="docutils literal notranslate"><span class="pre">re.compile</span></code>), especially if it is a lot of column names, and you are <em>lazy</em> like me ð</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/tidyverse/tidyr/raw/master/data-raw/billboard.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>artist</th>
      <th>track</th>
      <th>time</th>
      <th>date.entered</th>
      <th>wk1</th>
      <th>wk2</th>
      <th>wk3</th>
      <th>wk4</th>
      <th>wk5</th>
      <th>...</th>
      <th>wk67</th>
      <th>wk68</th>
      <th>wk69</th>
      <th>wk70</th>
      <th>wk71</th>
      <th>wk72</th>
      <th>wk73</th>
      <th>wk74</th>
      <th>wk75</th>
      <th>wk76</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep...</td>
      <td>4:22</td>
      <td>2000-02-26</td>
      <td>87</td>
      <td>82.0</td>
      <td>72.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000</td>
      <td>2Ge+her</td>
      <td>The Hardest Part Of ...</td>
      <td>3:15</td>
      <td>2000-09-02</td>
      <td>91</td>
      <td>87.0</td>
      <td>92.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Kryptonite</td>
      <td>3:53</td>
      <td>2000-04-08</td>
      <td>81</td>
      <td>70.0</td>
      <td>68.0</td>
      <td>67.0</td>
      <td>66.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Loser</td>
      <td>4:24</td>
      <td>2000-10-21</td>
      <td>76</td>
      <td>76.0</td>
      <td>72.0</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000</td>
      <td>504 Boyz</td>
      <td>Wobble Wobble</td>
      <td>3:35</td>
      <td>2000-04-15</td>
      <td>57</td>
      <td>34.0</td>
      <td>25.0</td>
      <td>17.0</td>
      <td>17.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>312</th>
      <td>2000</td>
      <td>Yankee Grey</td>
      <td>Another Nine Minutes</td>
      <td>3:10</td>
      <td>2000-04-29</td>
      <td>86</td>
      <td>83.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>83.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>313</th>
      <td>2000</td>
      <td>Yearwood, Trisha</td>
      <td>Real Live Woman</td>
      <td>3:55</td>
      <td>2000-04-01</td>
      <td>85</td>
      <td>83.0</td>
      <td>83.0</td>
      <td>82.0</td>
      <td>81.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>314</th>
      <td>2000</td>
      <td>Ying Yang Twins</td>
      <td>Whistle While You Tw...</td>
      <td>4:19</td>
      <td>2000-03-18</td>
      <td>95</td>
      <td>94.0</td>
      <td>91.0</td>
      <td>85.0</td>
      <td>84.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>315</th>
      <td>2000</td>
      <td>Zombie Nation</td>
      <td>Kernkraft 400</td>
      <td>3:30</td>
      <td>2000-09-02</td>
      <td>99</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>316</th>
      <td>2000</td>
      <td>matchbox twenty</td>
      <td>Bent</td>
      <td>4:12</td>
      <td>2000-04-29</td>
      <td>60</td>
      <td>37.0</td>
      <td>29.0</td>
      <td>24.0</td>
      <td>22.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>317 rows Ã 81 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># unpivot all columns that start with &#39;wk&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">column_names</span> <span class="o">=</span> <span class="n">janitor</span><span class="o">.</span><span class="n">patterns</span><span class="p">(</span><span class="s2">&quot;^(wk)&quot;</span><span class="p">),</span>
                <span class="n">names_to</span><span class="o">=</span><span class="s1">&#39;week&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>artist</th>
      <th>date.entered</th>
      <th>time</th>
      <th>track</th>
      <th>year</th>
      <th>week</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2 Pac</td>
      <td>2000-02-26</td>
      <td>4:22</td>
      <td>Baby Don't Cry (Keep...</td>
      <td>2000</td>
      <td>wk1</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2 Pac</td>
      <td>2000-02-26</td>
      <td>4:22</td>
      <td>Baby Don't Cry (Keep...</td>
      <td>2000</td>
      <td>wk2</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2 Pac</td>
      <td>2000-02-26</td>
      <td>4:22</td>
      <td>Baby Don't Cry (Keep...</td>
      <td>2000</td>
      <td>wk3</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2 Pac</td>
      <td>2000-02-26</td>
      <td>4:22</td>
      <td>Baby Don't Cry (Keep...</td>
      <td>2000</td>
      <td>wk4</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2 Pac</td>
      <td>2000-02-26</td>
      <td>4:22</td>
      <td>Baby Don't Cry (Keep...</td>
      <td>2000</td>
      <td>wk5</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>24087</th>
      <td>matchbox twenty</td>
      <td>2000-04-29</td>
      <td>4:12</td>
      <td>Bent</td>
      <td>2000</td>
      <td>wk72</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24088</th>
      <td>matchbox twenty</td>
      <td>2000-04-29</td>
      <td>4:12</td>
      <td>Bent</td>
      <td>2000</td>
      <td>wk73</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24089</th>
      <td>matchbox twenty</td>
      <td>2000-04-29</td>
      <td>4:12</td>
      <td>Bent</td>
      <td>2000</td>
      <td>wk74</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24090</th>
      <td>matchbox twenty</td>
      <td>2000-04-29</td>
      <td>4:12</td>
      <td>Bent</td>
      <td>2000</td>
      <td>wk75</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24091</th>
      <td>matchbox twenty</td>
      <td>2000-04-29</td>
      <td>4:12</td>
      <td>Bent</td>
      <td>2000</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>24092 rows Ã 7 columns</p>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> can also unpivot paired columns. Letâs look at an example from pandasâ <code class="docutils literal notranslate"><span class="pre">wide_to_long</span></code> docs :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;famid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;birth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;ht1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.8</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">],</span>
    <span class="s1">&#39;ht2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.4</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>famid</th>
      <th>birth</th>
      <th>ht1</th>
      <th>ht2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>2.8</td>
      <td>3.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>2.9</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>2.2</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>1</td>
      <td>2.0</td>
      <td>3.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>2</td>
      <td>1.8</td>
      <td>2.8</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>3</td>
      <td>1.9</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>1</td>
      <td>2.2</td>
      <td>3.3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>2</td>
      <td>2.3</td>
      <td>3.4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>3</td>
      <td>2.1</td>
      <td>2.9</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In the data above, the <code class="docutils literal notranslate"><span class="pre">height</span></code>(ht) is paired with <code class="docutils literal notranslate"><span class="pre">age</span></code>(numbers). Letâs see how <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> handles this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;famid&#39;</span><span class="p">,</span><span class="s1">&#39;birth&#39;</span><span class="p">],</span>
                <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;.value&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">),</span>
                <span class="n">names_pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;(ht)(\d)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>famid</th>
      <th>birth</th>
      <th>age</th>
      <th>ht</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2.8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1.8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2.8</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>1.9</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>12</th>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>13</th>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>3.3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>2.3</td>
    </tr>
    <tr>
      <th>15</th>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>3.4</td>
    </tr>
    <tr>
      <th>16</th>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>2.1</td>
    </tr>
    <tr>
      <th>17</th>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>2.9</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">.value</span></code> is used in <code class="docutils literal notranslate"><span class="pre">names_to</span></code>, a pairing is created between <code class="docutils literal notranslate"><span class="pre">names_to</span></code> and <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code>. For the example above, we get this pairing :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;.value&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;ht&quot;</span><span class="p">),</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="p">(</span>\<span class="n">d</span><span class="p">)}</span>
</pre></div>
</div>
<p>This tells the <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> function to keep values associated with <code class="docutils literal notranslate"><span class="pre">.value</span></code>(<code class="docutils literal notranslate"><span class="pre">ht</span></code>) as the column name, while values not associated with <code class="docutils literal notranslate"><span class="pre">.value</span></code>, in this case, the numbers, will be collated under a new column <code class="docutils literal notranslate"><span class="pre">age</span></code>. Internally, pandas <code class="docutils literal notranslate"><span class="pre">str.extractall</span></code> is used to get the capturing groups before reshaping. This level of abstraction, we believe, allows the user to focus on the task, and get things done faster.</p>
<p><code class="docutils literal notranslate"><span class="pre">pd.wide_to_long</span></code> handles this already, so why bother? Letâs look at another scenario where <code class="docutils literal notranslate"><span class="pre">pd.wide_to_long</span></code> would need a few more steps. <a class="reference external" href="https://community.rstudio.com/t/pivot-longer-on-multiple-column-sets-pairs/43958">Source Data</a> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;off_loc&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">],</span>
        <span class="s2">&quot;pt_loc&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">],</span>
        <span class="s2">&quot;pt_lat&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mf">100.07548220000001</span><span class="p">,</span>
            <span class="mf">75.191326</span><span class="p">,</span>
            <span class="mf">122.65134479999999</span><span class="p">,</span>
            <span class="mf">124.13553329999999</span><span class="p">,</span>
            <span class="mf">124.13553329999999</span><span class="p">,</span>
            <span class="mf">124.01028909999998</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;off_lat&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mf">121.271083</span><span class="p">,</span>
            <span class="mf">75.93845266</span><span class="p">,</span>
            <span class="mf">135.043791</span><span class="p">,</span>
            <span class="mf">134.51128400000002</span><span class="p">,</span>
            <span class="mf">134.484374</span><span class="p">,</span>
            <span class="mf">137.962195</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;pt_long&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mf">4.472089953</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">144.387785</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">40.45611048</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">46.07156181</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">46.07156181</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">46.01594293</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;off_long&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="o">-</span><span class="mf">7.188632000000001</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">143.2288569</span><span class="p">,</span>
            <span class="mf">21.242563</span><span class="p">,</span>
            <span class="mf">40.937416999999996</span><span class="p">,</span>
            <span class="mf">40.78472</span><span class="p">,</span>
            <span class="mf">22.905889000000002</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>off_loc</th>
      <th>pt_loc</th>
      <th>pt_lat</th>
      <th>off_lat</th>
      <th>pt_long</th>
      <th>off_long</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>G</td>
      <td>100.075482</td>
      <td>121.271083</td>
      <td>4.472090</td>
      <td>-7.188632</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>H</td>
      <td>75.191326</td>
      <td>75.938453</td>
      <td>-144.387785</td>
      <td>-143.228857</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>I</td>
      <td>122.651345</td>
      <td>135.043791</td>
      <td>-40.456110</td>
      <td>21.242563</td>
    </tr>
    <tr>
      <th>3</th>
      <td>D</td>
      <td>J</td>
      <td>124.135533</td>
      <td>134.511284</td>
      <td>-46.071562</td>
      <td>40.937417</td>
    </tr>
    <tr>
      <th>4</th>
      <td>E</td>
      <td>K</td>
      <td>124.135533</td>
      <td>134.484374</td>
      <td>-46.071562</td>
      <td>40.784720</td>
    </tr>
    <tr>
      <th>5</th>
      <td>F</td>
      <td>L</td>
      <td>124.010289</td>
      <td>137.962195</td>
      <td>-46.015943</td>
      <td>22.905889</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can unpivot with <code class="docutils literal notranslate"><span class="pre">pd.wide_to_long</span></code> by first reorganising the columns :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
               <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc_off</th>
      <th>loc_pt</th>
      <th>lat_pt</th>
      <th>lat_off</th>
      <th>long_pt</th>
      <th>long_off</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>G</td>
      <td>100.075482</td>
      <td>121.271083</td>
      <td>4.472090</td>
      <td>-7.188632</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>H</td>
      <td>75.191326</td>
      <td>75.938453</td>
      <td>-144.387785</td>
      <td>-143.228857</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>I</td>
      <td>122.651345</td>
      <td>135.043791</td>
      <td>-40.456110</td>
      <td>21.242563</td>
    </tr>
    <tr>
      <th>3</th>
      <td>D</td>
      <td>J</td>
      <td>124.135533</td>
      <td>134.511284</td>
      <td>-46.071562</td>
      <td>40.937417</td>
    </tr>
    <tr>
      <th>4</th>
      <td>E</td>
      <td>K</td>
      <td>124.135533</td>
      <td>134.484374</td>
      <td>-46.071562</td>
      <td>40.784720</td>
    </tr>
    <tr>
      <th>5</th>
      <td>F</td>
      <td>L</td>
      <td>124.010289</td>
      <td>137.962195</td>
      <td>-46.015943</td>
      <td>22.905889</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now, we can unpivot :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span>
    <span class="n">df1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span>
    <span class="n">stubnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;long&quot;</span><span class="p">],</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="p">,</span>
    <span class="n">i</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span>
    <span class="n">j</span><span class="o">=</span><span class="s2">&quot;set&quot;</span><span class="p">,</span>
    <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;\w+&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>loc</th>
      <th>lat</th>
      <th>long</th>
    </tr>
    <tr>
      <th>index</th>
      <th>set</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">0</th>
      <th>off</th>
      <td>A</td>
      <td>121.271083</td>
      <td>-7.188632</td>
    </tr>
    <tr>
      <th>pt</th>
      <td>G</td>
      <td>100.075482</td>
      <td>4.472090</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>off</th>
      <td>B</td>
      <td>75.938453</td>
      <td>-143.228857</td>
    </tr>
    <tr>
      <th>pt</th>
      <td>H</td>
      <td>75.191326</td>
      <td>-144.387785</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2</th>
      <th>off</th>
      <td>C</td>
      <td>135.043791</td>
      <td>21.242563</td>
    </tr>
    <tr>
      <th>pt</th>
      <td>I</td>
      <td>122.651345</td>
      <td>-40.456110</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">3</th>
      <th>off</th>
      <td>D</td>
      <td>134.511284</td>
      <td>40.937417</td>
    </tr>
    <tr>
      <th>pt</th>
      <td>J</td>
      <td>124.135533</td>
      <td>-46.071562</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">4</th>
      <th>off</th>
      <td>E</td>
      <td>134.484374</td>
      <td>40.784720</td>
    </tr>
    <tr>
      <th>pt</th>
      <td>K</td>
      <td>124.135533</td>
      <td>-46.071562</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">5</th>
      <th>off</th>
      <td>F</td>
      <td>137.962195</td>
      <td>22.905889</td>
    </tr>
    <tr>
      <th>pt</th>
      <td>L</td>
      <td>124.010289</td>
      <td>-46.015943</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Notice that we had to reset the dataframe to get a unique index variable. We can abstract all this away, using <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">names_to</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;set&quot;</span><span class="p">,</span> <span class="s2">&quot;.value&quot;</span><span class="p">],</span>
                <span class="n">names_pattern</span><span class="o">=</span><span class="s2">&quot;(.+)_(.+)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>set</th>
      <th>loc</th>
      <th>lat</th>
      <th>long</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>off</td>
      <td>A</td>
      <td>121.271083</td>
      <td>-7.188632</td>
    </tr>
    <tr>
      <th>1</th>
      <td>off</td>
      <td>B</td>
      <td>75.938453</td>
      <td>-143.228857</td>
    </tr>
    <tr>
      <th>2</th>
      <td>off</td>
      <td>C</td>
      <td>135.043791</td>
      <td>21.242563</td>
    </tr>
    <tr>
      <th>3</th>
      <td>off</td>
      <td>D</td>
      <td>134.511284</td>
      <td>40.937417</td>
    </tr>
    <tr>
      <th>4</th>
      <td>off</td>
      <td>E</td>
      <td>134.484374</td>
      <td>40.784720</td>
    </tr>
    <tr>
      <th>5</th>
      <td>off</td>
      <td>F</td>
      <td>137.962195</td>
      <td>22.905889</td>
    </tr>
    <tr>
      <th>6</th>
      <td>pt</td>
      <td>G</td>
      <td>100.075482</td>
      <td>4.472090</td>
    </tr>
    <tr>
      <th>7</th>
      <td>pt</td>
      <td>H</td>
      <td>75.191326</td>
      <td>-144.387785</td>
    </tr>
    <tr>
      <th>8</th>
      <td>pt</td>
      <td>I</td>
      <td>122.651345</td>
      <td>-40.456110</td>
    </tr>
    <tr>
      <th>9</th>
      <td>pt</td>
      <td>J</td>
      <td>124.135533</td>
      <td>-46.071562</td>
    </tr>
    <tr>
      <th>10</th>
      <td>pt</td>
      <td>K</td>
      <td>124.135533</td>
      <td>-46.071562</td>
    </tr>
    <tr>
      <th>11</th>
      <td>pt</td>
      <td>L</td>
      <td>124.010289</td>
      <td>-46.015943</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Another way to see the pairings,</span>
<span class="c1"># to see what is linked to `.value`,</span>

<span class="c1"># names_to =     [&quot;set&quot;, &quot;.value&quot;]</span>
<span class="c1"># names_pattern = &quot;(.+)_(.+)&quot;</span>
<span class="c1"># column _names =   off_loc</span>
<span class="c1">#                   off_lat</span>
<span class="c1">#                   off_long</span>
</pre></div>
</div>
</div>
<p>Again, the key here is the <code class="docutils literal notranslate"><span class="pre">.value</span></code> symbol. Pairing <code class="docutils literal notranslate"><span class="pre">names_to</span></code> with <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code> and its results from <code class="docutils literal notranslate"><span class="pre">pd.str.extractall</span></code>, we get :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="o">--&gt;</span> <span class="p">(</span><span class="o">.+</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="n">off</span><span class="p">,</span> <span class="n">pt</span><span class="p">]</span> <span class="ow">and</span>
<span class="o">.</span><span class="n">value</span><span class="o">--&gt;</span> <span class="p">(</span><span class="o">.+</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="n">loc</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">]</span>
</pre></div>
</div>
<p>All values associated with <code class="docutils literal notranslate"><span class="pre">.value</span></code>(loc, lat, long) remain as column names, while values not associated with <code class="docutils literal notranslate"><span class="pre">.value</span></code>(off, pt) are lumped into a new column <code class="docutils literal notranslate"><span class="pre">set</span></code>.</p>
<p>Notice that we did not have to reset the index - <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> does that under the hood; <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> allows you to focus on what you want, so you can get it and move on.</p>
<p>Letâs look at another example, from <a class="reference external" href="https://stackoverflow.com/questions/45123924/convert-pandas-dataframe-from-wide-to-long/45124130">Stack Overflow</a> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;a_1&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;ab_1&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                    <span class="s1">&#39;ac_1&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;a_2&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                    <span class="s1">&#39;ab_2&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;ac_2&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">}])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a_1</th>
      <th>ab_1</th>
      <th>ac_1</th>
      <th>a_2</th>
      <th>ab_2</th>
      <th>ac_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The data above requires extracting <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">ab</span></code> and <code class="docutils literal notranslate"><span class="pre">ac</span></code> from <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">2</span></code>. This is another example of a paired column. We could solve this using <code class="docutils literal notranslate"><span class="pre">pd.wide_to_long</span></code>; infact there is a very good solution from <a class="reference external" href="https://stackoverflow.com/a/45124775/7175713">Stack Overflow</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">index</span>
<span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;ab&#39;</span><span class="p">,</span><span class="s1">&#39;ac&#39;</span><span class="p">],</span><span class="n">i</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="n">j</span><span class="o">=</span><span class="s1">&#39;num&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>a</th>
      <th>ab</th>
      <th>ac</th>
    </tr>
    <tr>
      <th>id</th>
      <th>num</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">0</th>
      <th>1</th>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Or you could simply pass the buck to <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;.value&#39;</span><span class="p">,</span><span class="s1">&#39;num&#39;</span><span class="p">),</span> <span class="n">names_sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num</th>
      <th>a</th>
      <th>ab</th>
      <th>ac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In the solution above, we used the <code class="docutils literal notranslate"><span class="pre">names_sep</span></code> argument, as it is more convenient. A few more examples to get you familiar with the <code class="docutils literal notranslate"><span class="pre">.value</span></code> symbol.</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/55403008/pandas-partial-melt-or-group-melt">Link to Source Data</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]],</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;ay&#39;</span><span class="p">,</span><span class="s1">&#39;az&#39;</span><span class="p">,</span><span class="s1">&#39;bx&#39;</span><span class="p">,</span><span class="s1">&#39;by&#39;</span><span class="p">,</span><span class="s1">&#39;bz&#39;</span><span class="p">])</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>ax</th>
      <th>ay</th>
      <th>az</th>
      <th>bx</th>
      <th>by</th>
      <th>bz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
                <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;.value&#39;</span><span class="p">),</span>
                <span class="n">names_pattern</span><span class="o">=</span><span class="s1">&#39;(.)(.)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>a</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>b</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>a</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>b</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>For the code above <code class="docutils literal notranslate"><span class="pre">.value</span></code> is paired with <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>(which become the new column names), while <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> are unpivoted into the <code class="docutils literal notranslate"><span class="pre">name</span></code> column.</p>
<p>In the dataframe below, we need to unpivot the data, keeping only the suffix <code class="docutils literal notranslate"><span class="pre">hi</span></code>, and pulling out the number between <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">g</span></code>. <a class="reference external" href="https://stackoverflow.com/questions/35929985/melt-a-data-table-with-a-column-pattern">Source Data</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A1g_hi&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s1">&#39;A2g_hi&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;A3g_hi&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                    <span class="s1">&#39;A4g_hi&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>A1g_hi</th>
      <th>A2g_hi</th>
      <th>A3g_hi</th>
      <th>A4g_hi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
                <span class="n">names_to</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;.value&#39;</span><span class="p">],</span>
                <span class="n">names_pattern</span><span class="o">=</span><span class="s2">&quot;A(\d)g_(hi)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>time</th>
      <th>hi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>4</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Letâs see an example where we have multiple values in a paired column, and we want them into separate columns. Again, our source is from <a class="reference external" href="https://stackoverflow.com/questions/64107566/how-to-pivot-longer-and-populate-with-fields-from-column-names-at-the-same-tim?noredirect=1#comment113369419_64107566">Stack Overflow</a> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Sony | TV | Model | value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;A222&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;A234&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;A4345&quot;</span><span class="p">},</span>
        <span class="s2">&quot;Sony | TV | Quantity | value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
        <span class="s2">&quot;Sony | TV | Max-quant | value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span>
        <span class="s2">&quot;Panasonic | TV | Model | value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;T232&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;S3424&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;X3421&quot;</span><span class="p">},</span>
        <span class="s2">&quot;Panasonic | TV | Quantity | value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="s2">&quot;Panasonic | TV | Max-quant | value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">11</span><span class="p">},</span>
        <span class="s2">&quot;Sanyo | Radio | Model | value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;S111&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;S1s1&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;S1s2&quot;</span><span class="p">},</span>
        <span class="s2">&quot;Sanyo | Radio | Quantity | value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
        <span class="s2">&quot;Sanyo | Radio | Max-quant | value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sony | TV | Model | value</th>
      <th>Sony | TV | Quantity | value</th>
      <th>Sony | TV | Max-quant | value</th>
      <th>Panasonic | TV | Model | value</th>
      <th>Panasonic | TV | Quantity | value</th>
      <th>Panasonic | TV | Max-quant | value</th>
      <th>Sanyo | Radio | Model | value</th>
      <th>Sanyo | Radio | Quantity | value</th>
      <th>Sanyo | Radio | Max-quant | value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A222</td>
      <td>5</td>
      <td>10</td>
      <td>T232</td>
      <td>1</td>
      <td>10</td>
      <td>S111</td>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A234</td>
      <td>5</td>
      <td>9</td>
      <td>S3424</td>
      <td>5</td>
      <td>12</td>
      <td>S1s1</td>
      <td>2</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A4345</td>
      <td>4</td>
      <td>9</td>
      <td>X3421</td>
      <td>1</td>
      <td>11</td>
      <td>S1s2</td>
      <td>4</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The goal is to reshape the data into long format, with separate columns for <code class="docutils literal notranslate"><span class="pre">Manufacturer</span></code>(Sony,â¦), <code class="docutils literal notranslate"><span class="pre">Device</span></code>(TV, Radio), <code class="docutils literal notranslate"><span class="pre">Model</span></code>(S3424, â¦), <code class="docutils literal notranslate"><span class="pre">maximum</span> <span class="pre">quantity</span></code> and <code class="docutils literal notranslate"><span class="pre">quantity</span></code>.</p>
<p>Below is the <a class="reference external" href="https://stackoverflow.com/a/64107688/7175713">accepted solution</a> on Stack Overflow :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># Create a multiIndex column header</span>
<span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
    <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;\s?\|\s?&quot;</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Reshape the dataframe using</span>
<span class="c1"># `set_index`, `droplevel`, and `stack`</span>
<span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
 <span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
 <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
 <span class="o">.</span><span class="n">rename_axis</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Manufacturer&quot;</span><span class="p">,</span> <span class="s2">&quot;Device&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span><span class="p">])</span>
 <span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
 <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
 <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;level_0&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
 <span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Manufacturer</th>
      <th>Device</th>
      <th>Model</th>
      <th>Max-quant</th>
      <th>Quantity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Panasonic</td>
      <td>TV</td>
      <td>S3424</td>
      <td>12.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Panasonic</td>
      <td>TV</td>
      <td>T232</td>
      <td>10.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Panasonic</td>
      <td>TV</td>
      <td>X3421</td>
      <td>11.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sanyo</td>
      <td>Radio</td>
      <td>S111</td>
      <td>9.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sanyo</td>
      <td>Radio</td>
      <td>S1s1</td>
      <td>9.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Sanyo</td>
      <td>Radio</td>
      <td>S1s2</td>
      <td>10.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Sony</td>
      <td>TV</td>
      <td>A222</td>
      <td>10.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Sony</td>
      <td>TV</td>
      <td>A234</td>
      <td>9.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Sony</td>
      <td>TV</td>
      <td>A4345</td>
      <td>9.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Or, we could use <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code>, along with <code class="docutils literal notranslate"><span class="pre">.value</span></code> in <code class="docutils literal notranslate"><span class="pre">names_to</span></code> and a regular expression in <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
        <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Manufacturer&quot;</span><span class="p">,</span> <span class="s2">&quot;Device&quot;</span><span class="p">,</span> <span class="s2">&quot;.value&quot;</span><span class="p">),</span>
        <span class="n">names_pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;(.+)\|(.+)\|(.+)\|.*&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Manufacturer</th>
      <th>Device</th>
      <th>Model</th>
      <th>Quantity</th>
      <th>Max-quant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Sony</td>
      <td>TV</td>
      <td>A222</td>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sony</td>
      <td>TV</td>
      <td>A234</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sony</td>
      <td>TV</td>
      <td>A4345</td>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Panasonic</td>
      <td>TV</td>
      <td>T232</td>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Panasonic</td>
      <td>TV</td>
      <td>S3424</td>
      <td>5</td>
      <td>12</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Panasonic</td>
      <td>TV</td>
      <td>X3421</td>
      <td>1</td>
      <td>11</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Sanyo</td>
      <td>Radio</td>
      <td>S111</td>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Sanyo</td>
      <td>Radio</td>
      <td>S1s1</td>
      <td>2</td>
      <td>9</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Sanyo</td>
      <td>Radio</td>
      <td>S1s2</td>
      <td>4</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The cleanup (removal of whitespace in the column names) is left as an exercise for the reader.</p>
<p>One more example on the <code class="docutils literal notranslate"><span class="pre">.value</span></code> symbol for paired columns <a class="reference external" href="https://stackoverflow.com/questions/59477686/python-pandas-melt-single-column-into-two-seperate">Source Data</a> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                   <span class="s1">&#39;A_value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span>
                   <span class="s1">&#39;D_value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">45</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>A_value</th>
      <th>D_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>50</td>
      <td>60</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>33</td>
      <td>45</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
                <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;value_type&#39;</span><span class="p">,</span> <span class="s1">&#39;.value&#39;</span><span class="p">),</span>
                <span class="n">names_sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>value_type</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>A</td>
      <td>50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>D</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>A</td>
      <td>33</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>D</td>
      <td>45</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>There are scenarios where we need to unpivot the data, but only keep some specific names in the unpivoted data. Letâs see an example below: <a class="reference external" href="https://stackoverflow.com/questions/59550804/melt-column-by-substring-of-the-columns-name-in-pandas-python">Source Data</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                   <span class="s1">&#39;A_target_word_gd&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
                   <span class="s1">&#39;A_target_word_fd&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
                   <span class="s1">&#39;B_target_word_gd&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
                   <span class="s1">&#39;B_target_word_fd&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
                   <span class="s1">&#39;subject_type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mild&#39;</span><span class="p">,</span> <span class="s1">&#39;moderate&#39;</span><span class="p">]})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject</th>
      <th>A_target_word_gd</th>
      <th>A_target_word_fd</th>
      <th>B_target_word_gd</th>
      <th>B_target_word_fd</th>
      <th>subject_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>mild</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>moderate</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In the dataframe above, <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> represent conditions, while the suffixes <code class="docutils literal notranslate"><span class="pre">gd</span></code> and <code class="docutils literal notranslate"><span class="pre">fd</span></code> represent value types. We are not interested in the words in the middle (<code class="docutils literal notranslate"><span class="pre">_target_word</span></code>). We could solve it this way (this is the chosen solution, copied from <a class="reference external" href="https://stackoverflow.com/a/59550967/7175713">Stack Overflow</a>) :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_df</span> <span class="o">=</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;subject_type&#39;</span><span class="p">,</span><span class="s1">&#39;subject&#39;</span><span class="p">],</span>
                <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
           <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="s1">&#39;subject_type&#39;</span><span class="p">])</span>
         <span class="p">)</span>
<span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;cond&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;abc&#39;</span><span class="p">]</span>
                <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
                <span class="p">)</span>
<span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;value_type&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">new_df</span>
                      <span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
                      <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                      <span class="p">)</span>
<span class="n">new_df</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_type</th>
      <th>subject</th>
      <th>value</th>
      <th>cond</th>
      <th>value_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mild</td>
      <td>1</td>
      <td>1</td>
      <td>A</td>
      <td>gd</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mild</td>
      <td>1</td>
      <td>2</td>
      <td>A</td>
      <td>fd</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mild</td>
      <td>1</td>
      <td>3</td>
      <td>B</td>
      <td>gd</td>
    </tr>
    <tr>
      <th>6</th>
      <td>mild</td>
      <td>1</td>
      <td>4</td>
      <td>B</td>
      <td>fd</td>
    </tr>
    <tr>
      <th>1</th>
      <td>moderate</td>
      <td>2</td>
      <td>11</td>
      <td>A</td>
      <td>gd</td>
    </tr>
    <tr>
      <th>3</th>
      <td>moderate</td>
      <td>2</td>
      <td>12</td>
      <td>A</td>
      <td>fd</td>
    </tr>
    <tr>
      <th>5</th>
      <td>moderate</td>
      <td>2</td>
      <td>13</td>
      <td>B</td>
      <td>gd</td>
    </tr>
    <tr>
      <th>7</th>
      <td>moderate</td>
      <td>2</td>
      <td>14</td>
      <td>B</td>
      <td>fd</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Or, we could just pass the buck to <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;subject_type&quot;</span><span class="p">],</span>
    <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;cond&quot;</span><span class="p">,</span> <span class="s2">&quot;value_type&quot;</span><span class="p">),</span>
    <span class="n">names_pattern</span><span class="o">=</span><span class="s2">&quot;([A-Z]).*(gd|fd)&quot;</span><span class="p">,</span>
<span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject</th>
      <th>subject_type</th>
      <th>cond</th>
      <th>value_type</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>mild</td>
      <td>A</td>
      <td>gd</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>mild</td>
      <td>A</td>
      <td>fd</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>mild</td>
      <td>B</td>
      <td>gd</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>mild</td>
      <td>B</td>
      <td>fd</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>moderate</td>
      <td>A</td>
      <td>gd</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>moderate</td>
      <td>A</td>
      <td>fd</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>moderate</td>
      <td>B</td>
      <td>gd</td>
      <td>13</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>moderate</td>
      <td>B</td>
      <td>fd</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In the above, we pass in the new names of the columns to <code class="docutils literal notranslate"><span class="pre">names_to</span></code>(âcondâ, âvalue_typeâ), and pass the groups to be extracted as a regular expression to <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code>.</p>
<p>Hereâs another example where <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> abstracts the process and makes reshaping easier.</p>
<p>In the dataframe below, we would like to unpivot the data and separate the column names into individual columns(<code class="docutils literal notranslate"><span class="pre">vault</span></code> should be an <code class="docutils literal notranslate"><span class="pre">event</span></code> column, <code class="docutils literal notranslate"><span class="pre">2012</span></code> should be a <code class="docutils literal notranslate"><span class="pre">year</span></code> column and <code class="docutils literal notranslate"><span class="pre">f</span></code> should be a <code class="docutils literal notranslate"><span class="pre">gender</span></code> column). <a class="reference external" href="https://dcl-wrangle.stanford.edu/pivot-advanced.html">Source Data</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;United States&quot;</span><span class="p">,</span> <span class="s2">&quot;Russia&quot;</span><span class="p">,</span> <span class="s2">&quot;China&quot;</span><span class="p">],</span>
                <span class="s2">&quot;vault_2012_f&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">48.132</span><span class="p">,</span>
                    <span class="mf">46.36600000000001</span><span class="p">,</span>
                    <span class="mf">44.266000000000005</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s2">&quot;vault_2012_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">46.632</span><span class="p">,</span> <span class="mf">46.86600000000001</span><span class="p">,</span> <span class="mf">48.316</span><span class="p">],</span>
                <span class="s2">&quot;vault_2016_f&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">46.86600000000001</span><span class="p">,</span>
                    <span class="mf">45.733000000000004</span><span class="p">,</span>
                    <span class="mf">44.332</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s2">&quot;vault_2016_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.865</span><span class="p">,</span> <span class="mf">46.033</span><span class="p">,</span> <span class="mf">45.0</span><span class="p">],</span>
                <span class="s2">&quot;floor_2012_f&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.36600000000001</span><span class="p">,</span> <span class="mf">41.599</span><span class="p">,</span> <span class="mf">40.833</span><span class="p">],</span>
                <span class="s2">&quot;floor_2012_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.266000000000005</span><span class="p">,</span> <span class="mf">45.308</span><span class="p">,</span> <span class="mf">45.133</span><span class="p">],</span>
                <span class="s2">&quot;floor_2016_f&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.998999999999995</span><span class="p">,</span> <span class="mf">42.032</span><span class="p">,</span> <span class="mf">42.066</span><span class="p">],</span>
                <span class="s2">&quot;floor_2016_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">43.757</span><span class="p">,</span> <span class="mf">44.766000000000005</span><span class="p">,</span> <span class="mf">43.799</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>
<span class="n">df</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>vault_2012_f</th>
      <th>vault_2012_m</th>
      <th>vault_2016_f</th>
      <th>vault_2016_m</th>
      <th>floor_2012_f</th>
      <th>floor_2012_m</th>
      <th>floor_2016_f</th>
      <th>floor_2016_m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>United States</td>
      <td>48.132</td>
      <td>46.632</td>
      <td>46.866</td>
      <td>45.865</td>
      <td>45.366</td>
      <td>45.266</td>
      <td>45.999</td>
      <td>43.757</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Russia</td>
      <td>46.366</td>
      <td>46.866</td>
      <td>45.733</td>
      <td>46.033</td>
      <td>41.599</td>
      <td>45.308</td>
      <td>42.032</td>
      <td>44.766</td>
    </tr>
    <tr>
      <th>2</th>
      <td>China</td>
      <td>44.266</td>
      <td>48.316</td>
      <td>44.332</td>
      <td>45.000</td>
      <td>40.833</td>
      <td>45.133</td>
      <td>42.066</td>
      <td>43.799</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We could achieve this with a combination of <code class="docutils literal notranslate"><span class="pre">pd.melt</span></code> and pandas string methods (or janitorâs deconcatenate_columns method); or we could, again, pass the buck to <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">,</span>
    <span class="n">names_to</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;event&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">],</span>
    <span class="n">names_sep</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="p">,</span>
    <span class="n">values_to</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>event</th>
      <th>year</th>
      <th>gender</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>United States</td>
      <td>vault</td>
      <td>2012</td>
      <td>f</td>
      <td>48.132</td>
    </tr>
    <tr>
      <th>1</th>
      <td>United States</td>
      <td>vault</td>
      <td>2012</td>
      <td>m</td>
      <td>46.632</td>
    </tr>
    <tr>
      <th>2</th>
      <td>United States</td>
      <td>vault</td>
      <td>2016</td>
      <td>f</td>
      <td>46.866</td>
    </tr>
    <tr>
      <th>3</th>
      <td>United States</td>
      <td>vault</td>
      <td>2016</td>
      <td>m</td>
      <td>45.865</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United States</td>
      <td>floor</td>
      <td>2012</td>
      <td>f</td>
      <td>45.366</td>
    </tr>
    <tr>
      <th>5</th>
      <td>United States</td>
      <td>floor</td>
      <td>2012</td>
      <td>m</td>
      <td>45.266</td>
    </tr>
    <tr>
      <th>6</th>
      <td>United States</td>
      <td>floor</td>
      <td>2016</td>
      <td>f</td>
      <td>45.999</td>
    </tr>
    <tr>
      <th>7</th>
      <td>United States</td>
      <td>floor</td>
      <td>2016</td>
      <td>m</td>
      <td>43.757</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Russia</td>
      <td>vault</td>
      <td>2012</td>
      <td>f</td>
      <td>46.366</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Russia</td>
      <td>vault</td>
      <td>2012</td>
      <td>m</td>
      <td>46.866</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Russia</td>
      <td>vault</td>
      <td>2016</td>
      <td>f</td>
      <td>45.733</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Russia</td>
      <td>vault</td>
      <td>2016</td>
      <td>m</td>
      <td>46.033</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Russia</td>
      <td>floor</td>
      <td>2012</td>
      <td>f</td>
      <td>41.599</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Russia</td>
      <td>floor</td>
      <td>2012</td>
      <td>m</td>
      <td>45.308</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Russia</td>
      <td>floor</td>
      <td>2016</td>
      <td>f</td>
      <td>42.032</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Russia</td>
      <td>floor</td>
      <td>2016</td>
      <td>m</td>
      <td>44.766</td>
    </tr>
    <tr>
      <th>16</th>
      <td>China</td>
      <td>vault</td>
      <td>2012</td>
      <td>f</td>
      <td>44.266</td>
    </tr>
    <tr>
      <th>17</th>
      <td>China</td>
      <td>vault</td>
      <td>2012</td>
      <td>m</td>
      <td>48.316</td>
    </tr>
    <tr>
      <th>18</th>
      <td>China</td>
      <td>vault</td>
      <td>2016</td>
      <td>f</td>
      <td>44.332</td>
    </tr>
    <tr>
      <th>19</th>
      <td>China</td>
      <td>vault</td>
      <td>2016</td>
      <td>m</td>
      <td>45.000</td>
    </tr>
    <tr>
      <th>20</th>
      <td>China</td>
      <td>floor</td>
      <td>2012</td>
      <td>f</td>
      <td>40.833</td>
    </tr>
    <tr>
      <th>21</th>
      <td>China</td>
      <td>floor</td>
      <td>2012</td>
      <td>m</td>
      <td>45.133</td>
    </tr>
    <tr>
      <th>22</th>
      <td>China</td>
      <td>floor</td>
      <td>2016</td>
      <td>f</td>
      <td>42.066</td>
    </tr>
    <tr>
      <th>23</th>
      <td>China</td>
      <td>floor</td>
      <td>2016</td>
      <td>m</td>
      <td>43.799</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>One more feature that <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> offers is to pass a list of regular expressions to <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code>. This comes in handy when one single regex cannot encapsulate similar columns for reshaping to long form. This idea is inspired by the <a class="reference external" href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html">melt</a> function in Râs <a class="reference external" href="https://rdatatable.gitlab.io/data.table/">data.table</a>. A couple of examples should make this clear.</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/61138600/tidy-dataset-with-pivot-longer-multiple-columns-into-two-columns">Source Data</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Avatar&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1&#39;</span><span class="p">:</span> <span class="s1">&#39;CCH_Poundâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_2&#39;</span><span class="p">:</span> <span class="s1">&#39;Joel_Daviâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_3&#39;</span><span class="p">:</span> <span class="s1">&#39;Wes_Studi&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1_FB_likes&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
  <span class="s1">&#39;actor_2_FB_likes&#39;</span><span class="p">:</span> <span class="mi">936</span><span class="p">,</span>
  <span class="s1">&#39;actor_3_FB_likes&#39;</span><span class="p">:</span> <span class="mi">855</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Pirates_of_the_Carâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1&#39;</span><span class="p">:</span> <span class="s1">&#39;Johnny_Deâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_2&#39;</span><span class="p">:</span> <span class="s1">&#39;Orlando_Bâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_3&#39;</span><span class="p">:</span> <span class="s1">&#39;Jack_Davenâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1_FB_likes&#39;</span><span class="p">:</span> <span class="mi">40000</span><span class="p">,</span>
  <span class="s1">&#39;actor_2_FB_likes&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
  <span class="s1">&#39;actor_3_FB_likes&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;The_Dark_Knight_Riâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1&#39;</span><span class="p">:</span> <span class="s1">&#39;Tom_Hardy&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_2&#39;</span><span class="p">:</span> <span class="s1">&#39;Christianâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_3&#39;</span><span class="p">:</span> <span class="s1">&#39;Joseph_Gorâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1_FB_likes&#39;</span><span class="p">:</span> <span class="mi">27000</span><span class="p">,</span>
  <span class="s1">&#39;actor_2_FB_likes&#39;</span><span class="p">:</span> <span class="mi">23000</span><span class="p">,</span>
  <span class="s1">&#39;actor_3_FB_likes&#39;</span><span class="p">:</span> <span class="mi">23000</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;John_Carter&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1&#39;</span><span class="p">:</span> <span class="s1">&#39;Daryl_Sabâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_2&#39;</span><span class="p">:</span> <span class="s1">&#39;Samantha_â¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_3&#39;</span><span class="p">:</span> <span class="s1">&#39;Polly_Walkâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1_FB_likes&#39;</span><span class="p">:</span> <span class="mi">640</span><span class="p">,</span>
  <span class="s1">&#39;actor_2_FB_likes&#39;</span><span class="p">:</span> <span class="mi">632</span><span class="p">,</span>
  <span class="s1">&#39;actor_3_FB_likes&#39;</span><span class="p">:</span> <span class="mi">530</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Spider-Man_3&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1&#39;</span><span class="p">:</span> <span class="s1">&#39;J.K._Simmâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_2&#39;</span><span class="p">:</span> <span class="s1">&#39;James_Fraâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_3&#39;</span><span class="p">:</span> <span class="s1">&#39;Kirsten_Duâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1_FB_likes&#39;</span><span class="p">:</span> <span class="mi">24000</span><span class="p">,</span>
  <span class="s1">&#39;actor_2_FB_likes&#39;</span><span class="p">:</span> <span class="mi">11000</span><span class="p">,</span>
  <span class="s1">&#39;actor_3_FB_likes&#39;</span><span class="p">:</span> <span class="mi">4000</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Tangled&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1&#39;</span><span class="p">:</span> <span class="s1">&#39;Brad_Garrâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_2&#39;</span><span class="p">:</span> <span class="s1">&#39;Donna_Murâ¦&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_3&#39;</span><span class="p">:</span> <span class="s1">&#39;M.C._Gainey&#39;</span><span class="p">,</span>
  <span class="s1">&#39;actor_1_FB_likes&#39;</span><span class="p">:</span> <span class="mi">799</span><span class="p">,</span>
  <span class="s1">&#39;actor_2_FB_likes&#39;</span><span class="p">:</span> <span class="mi">553</span><span class="p">,</span>
  <span class="s1">&#39;actor_3_FB_likes&#39;</span><span class="p">:</span> <span class="mi">284</span><span class="p">}]</span>
<span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>actor_1</th>
      <th>actor_2</th>
      <th>actor_3</th>
      <th>actor_1_FB_likes</th>
      <th>actor_2_FB_likes</th>
      <th>actor_3_FB_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>CCH_Poundâ¦</td>
      <td>Joel_Daviâ¦</td>
      <td>Wes_Studi</td>
      <td>1000</td>
      <td>936</td>
      <td>855</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Pirates_of_the_Carâ¦</td>
      <td>Johnny_Deâ¦</td>
      <td>Orlando_Bâ¦</td>
      <td>Jack_Davenâ¦</td>
      <td>40000</td>
      <td>5000</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The_Dark_Knight_Riâ¦</td>
      <td>Tom_Hardy</td>
      <td>Christianâ¦</td>
      <td>Joseph_Gorâ¦</td>
      <td>27000</td>
      <td>23000</td>
      <td>23000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>John_Carter</td>
      <td>Daryl_Sabâ¦</td>
      <td>Samantha_â¦</td>
      <td>Polly_Walkâ¦</td>
      <td>640</td>
      <td>632</td>
      <td>530</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Spider-Man_3</td>
      <td>J.K._Simmâ¦</td>
      <td>James_Fraâ¦</td>
      <td>Kirsten_Duâ¦</td>
      <td>24000</td>
      <td>11000</td>
      <td>4000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tangled</td>
      <td>Brad_Garrâ¦</td>
      <td>Donna_Murâ¦</td>
      <td>M.C._Gainey</td>
      <td>799</td>
      <td>553</td>
      <td>284</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Above, we have a dataframe of movie titles, actors, and their facebook likes. It would be great if we could transform this into a long form, with just the title, the actor names, and the number of likes. Letâs look at a possible solution :</p>
<p>First, we reshape the columns, so that the numbers appear at the end.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">pat</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;(?P&lt;actor&gt;.+)_(?P&lt;num&gt;\d)_(?P&lt;likes&gt;.+)&quot;</span>
<span class="n">repl</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="si">{</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;actor&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;likes&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
<span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">repl</span><span class="p">)</span>
<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>actor_1</th>
      <th>actor_2</th>
      <th>actor_3</th>
      <th>actor_FB_likes_1</th>
      <th>actor_FB_likes_2</th>
      <th>actor_FB_likes_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>CCH_Poundâ¦</td>
      <td>Joel_Daviâ¦</td>
      <td>Wes_Studi</td>
      <td>1000</td>
      <td>936</td>
      <td>855</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Pirates_of_the_Carâ¦</td>
      <td>Johnny_Deâ¦</td>
      <td>Orlando_Bâ¦</td>
      <td>Jack_Davenâ¦</td>
      <td>40000</td>
      <td>5000</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The_Dark_Knight_Riâ¦</td>
      <td>Tom_Hardy</td>
      <td>Christianâ¦</td>
      <td>Joseph_Gorâ¦</td>
      <td>27000</td>
      <td>23000</td>
      <td>23000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>John_Carter</td>
      <td>Daryl_Sabâ¦</td>
      <td>Samantha_â¦</td>
      <td>Polly_Walkâ¦</td>
      <td>640</td>
      <td>632</td>
      <td>530</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Spider-Man_3</td>
      <td>J.K._Simmâ¦</td>
      <td>James_Fraâ¦</td>
      <td>Kirsten_Duâ¦</td>
      <td>24000</td>
      <td>11000</td>
      <td>4000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tangled</td>
      <td>Brad_Garrâ¦</td>
      <td>Donna_Murâ¦</td>
      <td>M.C._Gainey</td>
      <td>799</td>
      <td>553</td>
      <td>284</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now, we can reshape, using <code class="docutils literal notranslate"><span class="pre">pd.wide_to_long</span></code> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span>
        <span class="n">stubnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;actor&#39;</span><span class="p">,</span> <span class="s1">&#39;actor_FB_likes&#39;</span><span class="p">],</span>
        <span class="n">i</span><span class="o">=</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>actor</th>
      <th>actor_FB_likes</th>
    </tr>
    <tr>
      <th>title</th>
      <th>group</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Avatar</th>
      <th>1</th>
      <td>CCH_Poundâ¦</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>Pirates_of_the_Carâ¦</th>
      <th>1</th>
      <td>Johnny_Deâ¦</td>
      <td>40000</td>
    </tr>
    <tr>
      <th>The_Dark_Knight_Riâ¦</th>
      <th>1</th>
      <td>Tom_Hardy</td>
      <td>27000</td>
    </tr>
    <tr>
      <th>John_Carter</th>
      <th>1</th>
      <td>Daryl_Sabâ¦</td>
      <td>640</td>
    </tr>
    <tr>
      <th>Spider-Man_3</th>
      <th>1</th>
      <td>J.K._Simmâ¦</td>
      <td>24000</td>
    </tr>
    <tr>
      <th>Tangled</th>
      <th>1</th>
      <td>Brad_Garrâ¦</td>
      <td>799</td>
    </tr>
    <tr>
      <th>Avatar</th>
      <th>2</th>
      <td>Joel_Daviâ¦</td>
      <td>936</td>
    </tr>
    <tr>
      <th>Pirates_of_the_Carâ¦</th>
      <th>2</th>
      <td>Orlando_Bâ¦</td>
      <td>5000</td>
    </tr>
    <tr>
      <th>The_Dark_Knight_Riâ¦</th>
      <th>2</th>
      <td>Christianâ¦</td>
      <td>23000</td>
    </tr>
    <tr>
      <th>John_Carter</th>
      <th>2</th>
      <td>Samantha_â¦</td>
      <td>632</td>
    </tr>
    <tr>
      <th>Spider-Man_3</th>
      <th>2</th>
      <td>James_Fraâ¦</td>
      <td>11000</td>
    </tr>
    <tr>
      <th>Tangled</th>
      <th>2</th>
      <td>Donna_Murâ¦</td>
      <td>553</td>
    </tr>
    <tr>
      <th>Avatar</th>
      <th>3</th>
      <td>Wes_Studi</td>
      <td>855</td>
    </tr>
    <tr>
      <th>Pirates_of_the_Carâ¦</th>
      <th>3</th>
      <td>Jack_Davenâ¦</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>The_Dark_Knight_Riâ¦</th>
      <th>3</th>
      <td>Joseph_Gorâ¦</td>
      <td>23000</td>
    </tr>
    <tr>
      <th>John_Carter</th>
      <th>3</th>
      <td>Polly_Walkâ¦</td>
      <td>530</td>
    </tr>
    <tr>
      <th>Spider-Man_3</th>
      <th>3</th>
      <td>Kirsten_Duâ¦</td>
      <td>4000</td>
    </tr>
    <tr>
      <th>Tangled</th>
      <th>3</th>
      <td>M.C._Gainey</td>
      <td>284</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We could attempt to solve it with <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code>, using the <code class="docutils literal notranslate"><span class="pre">.value</span></code> symbol :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;title&#39;</span><span class="p">,</span>
        <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;.value&quot;</span><span class="p">,</span><span class="s2">&quot;group&quot;</span><span class="p">),</span>
        <span class="n">names_pattern</span><span class="o">=</span><span class="s2">&quot;(.+)_(\d)$&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>group</th>
      <th>actor</th>
      <th>actor_FB_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>1</td>
      <td>CCH_Poundâ¦</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Avatar</td>
      <td>2</td>
      <td>Joel_Daviâ¦</td>
      <td>936</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Avatar</td>
      <td>3</td>
      <td>Wes_Studi</td>
      <td>855</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Pirates_of_the_Carâ¦</td>
      <td>1</td>
      <td>Johnny_Deâ¦</td>
      <td>40000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pirates_of_the_Carâ¦</td>
      <td>2</td>
      <td>Orlando_Bâ¦</td>
      <td>5000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Pirates_of_the_Carâ¦</td>
      <td>3</td>
      <td>Jack_Davenâ¦</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>The_Dark_Knight_Riâ¦</td>
      <td>1</td>
      <td>Tom_Hardy</td>
      <td>27000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>The_Dark_Knight_Riâ¦</td>
      <td>2</td>
      <td>Christianâ¦</td>
      <td>23000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>The_Dark_Knight_Riâ¦</td>
      <td>3</td>
      <td>Joseph_Gorâ¦</td>
      <td>23000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>John_Carter</td>
      <td>1</td>
      <td>Daryl_Sabâ¦</td>
      <td>640</td>
    </tr>
    <tr>
      <th>10</th>
      <td>John_Carter</td>
      <td>2</td>
      <td>Samantha_â¦</td>
      <td>632</td>
    </tr>
    <tr>
      <th>11</th>
      <td>John_Carter</td>
      <td>3</td>
      <td>Polly_Walkâ¦</td>
      <td>530</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Spider-Man_3</td>
      <td>1</td>
      <td>J.K._Simmâ¦</td>
      <td>24000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Spider-Man_3</td>
      <td>2</td>
      <td>James_Fraâ¦</td>
      <td>11000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Spider-Man_3</td>
      <td>3</td>
      <td>Kirsten_Duâ¦</td>
      <td>4000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Tangled</td>
      <td>1</td>
      <td>Brad_Garrâ¦</td>
      <td>799</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Tangled</td>
      <td>2</td>
      <td>Donna_Murâ¦</td>
      <td>553</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Tangled</td>
      <td>3</td>
      <td>M.C._Gainey</td>
      <td>284</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>What if we could just get our data in long form without the massaging? We know our data has a pattern to it â&gt; it either ends in a number or <em>likes</em>. Canât we take advantage of that? Yes, we can(I know, I know; it sounds like a campaign slogan ð¤ª)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;title&#39;</span><span class="p">,</span>
        <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;actor&quot;</span><span class="p">,</span> <span class="s2">&quot;num_likes&quot;</span><span class="p">),</span>
        <span class="n">names_pattern</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;\d$&#39;</span><span class="p">,</span> <span class="s1">&#39;likes$&#39;</span><span class="p">),</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>actor</th>
      <th>num_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>CCH_Poundâ¦</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Avatar</td>
      <td>Joel_Daviâ¦</td>
      <td>936</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Avatar</td>
      <td>Wes_Studi</td>
      <td>855</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Pirates_of_the_Carâ¦</td>
      <td>Johnny_Deâ¦</td>
      <td>40000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pirates_of_the_Carâ¦</td>
      <td>Orlando_Bâ¦</td>
      <td>5000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Pirates_of_the_Carâ¦</td>
      <td>Jack_Davenâ¦</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>The_Dark_Knight_Riâ¦</td>
      <td>Tom_Hardy</td>
      <td>27000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>The_Dark_Knight_Riâ¦</td>
      <td>Christianâ¦</td>
      <td>23000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>The_Dark_Knight_Riâ¦</td>
      <td>Joseph_Gorâ¦</td>
      <td>23000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>John_Carter</td>
      <td>Daryl_Sabâ¦</td>
      <td>640</td>
    </tr>
    <tr>
      <th>10</th>
      <td>John_Carter</td>
      <td>Samantha_â¦</td>
      <td>632</td>
    </tr>
    <tr>
      <th>11</th>
      <td>John_Carter</td>
      <td>Polly_Walkâ¦</td>
      <td>530</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Spider-Man_3</td>
      <td>J.K._Simmâ¦</td>
      <td>24000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Spider-Man_3</td>
      <td>James_Fraâ¦</td>
      <td>11000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Spider-Man_3</td>
      <td>Kirsten_Duâ¦</td>
      <td>4000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Tangled</td>
      <td>Brad_Garrâ¦</td>
      <td>799</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Tangled</td>
      <td>Donna_Murâ¦</td>
      <td>553</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Tangled</td>
      <td>M.C._Gainey</td>
      <td>284</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>A pairing of <code class="docutils literal notranslate"><span class="pre">names_to</span></code> and <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code> results in :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;actor&quot;</span><span class="p">:</span> <span class="s1">&#39;\d$&#39;</span><span class="p">,</span> <span class="s2">&quot;num_likes&quot;</span><span class="p">:</span> <span class="s1">&#39;likes$&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>The first regex looks for columns that end with a number, while the other looks for columns that end with <em>likes</em>. <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> will then look for columns that end with a number and lump all the values in those columns under the <code class="docutils literal notranslate"><span class="pre">actor</span></code> column, and also look for columns that end with <em>like</em> and combine all the values in those columns into a new column -&gt; <code class="docutils literal notranslate"><span class="pre">num_likes</span></code>. Underneath the hood, <code class="docutils literal notranslate"><span class="pre">numpy</span> <span class="pre">select</span></code> and <code class="docutils literal notranslate"><span class="pre">pd.Series.str.contains</span></code> are used to pull apart the columns into the new
columns.</p>
<p>Again, it is about the goal; we are not interested in the numbers (1,2,3), we only need the names of the actors, and their facebook likes. <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> aims to give as much flexibility as possible, in addition to ease of use, to allow the end user focus on the task.</p>
<p>Letâs take a look at another example. <a class="reference external" href="https://stackoverflow.com/questions/60439749/pair-wise-melt-in-pandas-dataframe">Source Data</a> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
 <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ABC&#39;</span><span class="p">,</span> <span class="s1">&#39;XYZ&#39;</span><span class="p">],</span>
 <span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
 <span class="s1">&#39;code1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
 <span class="s1">&#39;code2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">],</span>
 <span class="s1">&#39;type1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
 <span class="s1">&#39;type2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">]})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Name</th>
      <th>code</th>
      <th>code1</th>
      <th>code2</th>
      <th>type</th>
      <th>type1</th>
      <th>type2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>ABC</td>
      <td>1</td>
      <td>4.0</td>
      <td>8</td>
      <td>S</td>
      <td>E</td>
      <td>T</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>XYZ</td>
      <td>2</td>
      <td>NaN</td>
      <td>5</td>
      <td>R</td>
      <td>NaN</td>
      <td>U</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We cannot directly use <code class="docutils literal notranslate"><span class="pre">pd.wide_to_long</span></code> here without some massaging, as there is no definite suffix(the first <code class="docutils literal notranslate"><span class="pre">code</span></code> does not have a suffix), neither can we use <code class="docutils literal notranslate"><span class="pre">.value</span></code> here, again because there is no suffix. However, we can see a pattern where some columns start with <code class="docutils literal notranslate"><span class="pre">code</span></code>, and others start with <code class="docutils literal notranslate"><span class="pre">type</span></code>. Letâs see how <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> solves this for us :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">],</span>
        <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;code_all&quot;</span><span class="p">,</span> <span class="s2">&quot;type_all&quot;</span><span class="p">),</span>
        <span class="n">names_pattern</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;^code&quot;</span><span class="p">,</span> <span class="s2">&quot;^type&quot;</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Name</th>
      <th>code_all</th>
      <th>type_all</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>ABC</td>
      <td>1.0</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>ABC</td>
      <td>4.0</td>
      <td>E</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>ABC</td>
      <td>8.0</td>
      <td>T</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>XYZ</td>
      <td>2.0</td>
      <td>R</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>XYZ</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>XYZ</td>
      <td>5.0</td>
      <td>U</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The key here is passing the right regular expression, and ensuring the names in <code class="docutils literal notranslate"><span class="pre">names_to</span></code> is paired with the right regex in <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code>. So every column that starts with <code class="docutils literal notranslate"><span class="pre">code</span></code> will be included in the new <code class="docutils literal notranslate"><span class="pre">code_all</span></code> column; the same happens to the <code class="docutils literal notranslate"><span class="pre">type_all</span></code> column. Easy and flexible, right?</p>
<p>Letâs explore another example, from <a class="reference external" href="https://stackoverflow.com/questions/12466493/reshaping-multiple-sets-of-measurement-columns-wide-format-into-single-columns">Stack Overflow</a> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange1Start&quot;</span><span class="p">:</span> <span class="s2">&quot;1/1/90&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange1End&quot;</span><span class="p">:</span> <span class="s2">&quot;3/1/90&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Value1&quot;</span><span class="p">:</span> <span class="mf">4.4</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange2Start&quot;</span><span class="p">:</span> <span class="s2">&quot;4/5/91&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange2End&quot;</span><span class="p">:</span> <span class="s2">&quot;6/7/91&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Value2&quot;</span><span class="p">:</span> <span class="mf">6.2</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange3Start&quot;</span><span class="p">:</span> <span class="s2">&quot;5/5/95&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange3End&quot;</span><span class="p">:</span> <span class="s2">&quot;6/6/96&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Value3&quot;</span><span class="p">:</span> <span class="mf">3.3</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">])</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>DateRange1Start</th>
      <th>DateRange1End</th>
      <th>Value1</th>
      <th>DateRange2Start</th>
      <th>DateRange2End</th>
      <th>Value2</th>
      <th>DateRange3Start</th>
      <th>DateRange3End</th>
      <th>Value3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1/1/90</td>
      <td>3/1/90</td>
      <td>4.4</td>
      <td>4/5/91</td>
      <td>6/7/91</td>
      <td>6.2</td>
      <td>5/5/95</td>
      <td>6/6/96</td>
      <td>3.3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In the dataframe above, we need to reshape the data to have a start date, end date and value. For the <code class="docutils literal notranslate"><span class="pre">DateRange</span></code> columns, the numbers are embedded within the string, while for <code class="docutils literal notranslate"><span class="pre">value</span></code> it is appended at the end. One possible solution is to reshape the columns so that the numbers are at the end :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">pat</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;(?P&lt;head&gt;.+)(?P&lt;num&gt;\d)(?P&lt;tail&gt;.+)&quot;</span>
<span class="n">repl</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="si">{</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)</span><span class="si">}{</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;tail&#39;</span><span class="p">)</span><span class="si">}{</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
<span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span><span class="n">repl</span><span class="p">)</span>
<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>DateRangeStart1</th>
      <th>DateRangeEnd1</th>
      <th>Value1</th>
      <th>DateRangeStart2</th>
      <th>DateRangeEnd2</th>
      <th>Value2</th>
      <th>DateRangeStart3</th>
      <th>DateRangeEnd3</th>
      <th>Value3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1/1/90</td>
      <td>3/1/90</td>
      <td>4.4</td>
      <td>4/5/91</td>
      <td>6/7/91</td>
      <td>6.2</td>
      <td>5/5/95</td>
      <td>6/6/96</td>
      <td>3.3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now, we can unpivot:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span>
        <span class="n">stubnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DateRangeStart&#39;</span><span class="p">,</span> <span class="s1">&#39;DateRangeEnd&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">],</span>
         <span class="n">i</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span>
         <span class="n">j</span><span class="o">=</span><span class="s1">&#39;num&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>DateRangeStart</th>
      <th>DateRangeEnd</th>
      <th>Value</th>
    </tr>
    <tr>
      <th>ID</th>
      <th>num</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">1</th>
      <th>1</th>
      <td>1/1/90</td>
      <td>3/1/90</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4/5/91</td>
      <td>6/7/91</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5/5/95</td>
      <td>6/6/96</td>
      <td>3.3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">.value</span></code> symbol in pivot_longer:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span>
        <span class="n">names_to</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;.value&quot;</span><span class="p">,</span><span class="s1">&#39;num&#39;</span><span class="p">],</span>
        <span class="n">names_pattern</span><span class="o">=</span><span class="s2">&quot;(.+)(\d)$&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>num</th>
      <th>DateRangeStart</th>
      <th>DateRangeEnd</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1/1/90</td>
      <td>3/1/90</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>4/5/91</td>
      <td>6/7/91</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>5/5/95</td>
      <td>6/6/96</td>
      <td>3.3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Since we are not interested in the numbers, we can rewrite our code above :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df1</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span>
        <span class="n">names_to</span><span class="o">=</span><span class="s2">&quot;.value&quot;</span><span class="p">,</span>
        <span class="n">names_pattern</span><span class="o">=</span><span class="s2">&quot;(.+)\d$&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>DateRangeStart</th>
      <th>DateRangeEnd</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1/1/90</td>
      <td>3/1/90</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4/5/91</td>
      <td>6/7/91</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5/5/95</td>
      <td>6/6/96</td>
      <td>3.3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Or, we could allow pivot_longer worry about the massaging; simply pass to <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code> a list of regular expressions that match what we are after :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span>
        <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;DateRangeStart&quot;</span><span class="p">,</span> <span class="s2">&quot;DateRangeEnd&quot;</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">),</span>
        <span class="n">names_pattern</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Start$&quot;</span><span class="p">,</span> <span class="s2">&quot;End$&quot;</span><span class="p">,</span> <span class="s2">&quot;^Value&quot;</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>DateRangeStart</th>
      <th>DateRangeEnd</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1/1/90</td>
      <td>3/1/90</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4/5/91</td>
      <td>6/7/91</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5/5/95</td>
      <td>6/6/96</td>
      <td>3.3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The code above looks for columns that end with <em>Start</em>(<code class="docutils literal notranslate"><span class="pre">Start$</span></code>), aggregates all the values in those columns into <code class="docutils literal notranslate"><span class="pre">DateRangeStart</span></code> column, looks for columns that end with <em>End</em>(<code class="docutils literal notranslate"><span class="pre">End$</span></code>), aggregates all the values within those columns into <code class="docutils literal notranslate"><span class="pre">DateRangeEnd</span></code> column, and finally looks for columns that start with <em>Value</em>(<code class="docutils literal notranslate"><span class="pre">^Value</span></code>), and aggregates the values in those columns into the <code class="docutils literal notranslate"><span class="pre">Value</span></code> column. Just know the patterns, and pair them accordingly. Again, the goal is a focus on the
task, to make it simple for the end user.</p>
<p>What if we just want a subsection of the data? This is not a tidy form, but shows how you can limit your extractions.</p>
<p>Letâs look at another example <a class="reference external" href="https://stackoverflow.com/questions/64316129/how-to-efficiently-melt-multiple-columns-using-the-module-melt-in-pandas/64316306#64316306">Source Data</a> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Activity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;P1&#39;</span><span class="p">,</span> <span class="s1">&#39;P2&#39;</span><span class="p">],</span>
 <span class="s1">&#39;General&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AA&#39;</span><span class="p">,</span> <span class="s1">&#39;BB&#39;</span><span class="p">],</span>
 <span class="s1">&#39;m1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">],</span>
 <span class="s1">&#39;t1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;TA1&#39;</span><span class="p">,</span> <span class="s1">&#39;TB1&#39;</span><span class="p">],</span>
 <span class="s1">&#39;m2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">],</span>
 <span class="s1">&#39;t2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;TA2&#39;</span><span class="p">,</span> <span class="s1">&#39;TB2&#39;</span><span class="p">],</span>
 <span class="s1">&#39;m3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span>
 <span class="s1">&#39;t3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;TA3&#39;</span><span class="p">,</span> <span class="s1">&#39;TB3&#39;</span><span class="p">]})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Activity</th>
      <th>General</th>
      <th>m1</th>
      <th>t1</th>
      <th>m2</th>
      <th>t2</th>
      <th>m3</th>
      <th>t3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P1</td>
      <td>AA</td>
      <td>A1</td>
      <td>TA1</td>
      <td>A2</td>
      <td>TA2</td>
      <td>A3</td>
      <td>TA3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P2</td>
      <td>BB</td>
      <td>B1</td>
      <td>TB1</td>
      <td>B2</td>
      <td>TB2</td>
      <td>B3</td>
      <td>TB3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>This is a <a class="reference external" href="https://stackoverflow.com/a/64316306/7175713">solution</a> provided by yours truly :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                  <span class="n">i</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Activity&quot;</span><span class="p">,</span> <span class="s2">&quot;General&quot;</span><span class="p">],</span>
                  <span class="n">stubnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">],</span>
                  <span class="n">j</span><span class="o">=</span><span class="s2">&quot;number&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">set_axis</span><span class="p">([</span><span class="s2">&quot;Task&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Activity</th>
      <th>General</th>
      <th>Task</th>
      <th>M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P1</td>
      <td>AA</td>
      <td>TA1</td>
      <td>A1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P1</td>
      <td>AA</td>
      <td>TA2</td>
      <td>A2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P1</td>
      <td>AA</td>
      <td>TA3</td>
      <td>A3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P2</td>
      <td>BB</td>
      <td>TB1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P2</td>
      <td>BB</td>
      <td>TB2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>P2</td>
      <td>BB</td>
      <td>TB3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Or, we could use <code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code>, abstract the details, and focus on the task :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Activity&#39;</span><span class="p">,</span><span class="s1">&#39;General&#39;</span><span class="p">],</span>
                <span class="n">names_pattern</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;^m&#39;</span><span class="p">,</span><span class="s1">&#39;^t&#39;</span><span class="p">],</span>
                <span class="n">names_to</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;Task&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Activity</th>
      <th>General</th>
      <th>M</th>
      <th>Task</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P1</td>
      <td>AA</td>
      <td>A1</td>
      <td>TA1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P1</td>
      <td>AA</td>
      <td>A2</td>
      <td>TA2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P1</td>
      <td>AA</td>
      <td>A3</td>
      <td>TA3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P2</td>
      <td>BB</td>
      <td>B1</td>
      <td>TB1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P2</td>
      <td>BB</td>
      <td>B2</td>
      <td>TB2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>P2</td>
      <td>BB</td>
      <td>B3</td>
      <td>TB3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Alright, one last example :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                <span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
                <span class="s2">&quot;y1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
                <span class="s2">&quot;y2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>x1</th>
      <th>x2</th>
      <th>y1</th>
      <th>y2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
      <td>6</td>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
      <td>7</td>
      <td>9</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In the dataframe above, we are not really interested in the numbers affixed to <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>. We also notice that there is a pattern ,where some columns start with <code class="docutils literal notranslate"><span class="pre">x</span></code> and others start with <code class="docutils literal notranslate"><span class="pre">y</span></code>. <code class="docutils literal notranslate"><span class="pre">pd.wide_to_long</span></code> can handle this easily :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
        <span class="n">stubnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
        <span class="n">i</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
        <span class="n">j</span><span class="o">=</span><span class="s1">&#39;num&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>x</th>
      <th>y</th>
    </tr>
    <tr>
      <th>id</th>
      <th>num</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <th>1</th>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <th>1</th>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <th>1</th>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <th>2</th>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <th>2</th>
      <td>6</td>
      <td>11</td>
    </tr>
    <tr>
      <th>3</th>
      <th>2</th>
      <td>7</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>To get rid of the <code class="docutils literal notranslate"><span class="pre">num</span></code> variable, we can use <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.droplevel.html">droplevel</a>, combined with <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.reset_index.html">reset_index</a> (if you wish to integrate the <code class="docutils literal notranslate"><span class="pre">id</span></code> column back) :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
        <span class="n">stubnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
        <span class="n">i</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
        <span class="n">j</span><span class="o">=</span><span class="s1">&#39;num&#39;</span><span class="p">)</span>
<span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>6</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>7</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> can handle this as well, by passing a list of regular expressions to <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code>(again, we are not interested in the numbers affixed to <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>) :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span>
        <span class="n">names_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
        <span class="n">names_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;^x&#39;</span><span class="p">,</span> <span class="s1">&#39;^y&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>6</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>7</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We could also use <code class="docutils literal notranslate"><span class="pre">.value</span></code> as well to reshape the data :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span>
        <span class="n">names_to</span> <span class="o">=</span> <span class="s1">&#39;.value&#39;</span><span class="p">,</span>
        <span class="n">names_pattern</span> <span class="o">=</span> <span class="s1">&#39;(.).&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>6</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>7</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>And, if you want the numbers, easy-peasy :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span>
        <span class="n">names_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.value&#39;</span><span class="p">,</span><span class="s1">&#39;num&#39;</span><span class="p">],</span>
        <span class="n">names_pattern</span> <span class="o">=</span> <span class="s1">&#39;(.)(.)&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>num</th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>2</td>
      <td>6</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>1</td>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>2</td>
      <td>7</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pivot_longer</span></code> does not solve all problems; no function does. Its aim is to act as a single point for transformations, on single indexed dataframes, that require <code class="docutils literal notranslate"><span class="pre">pd.melt</span></code> or <code class="docutils literal notranslate"><span class="pre">pd.wide_to_long</span></code>, is also easy to use and offers more flexibility.</p>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_title.svg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pyjanitor_intro.html">pyjanitor Usage Walkthrough</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Pivot_Longer : One function to cover transformations from wide to long form.</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="Row_to_Names.html">row_to_names : Elevates a row to be the column names of a DataFrame.</a></li>
<li class="toctree-l2"><a class="reference internal" href="anime.html">Processing Anime Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="bad_values.html">Replacing Bad Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="bird_call.html">Processing Bird Call Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="board_games.html">Processing Board Game Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="dirty_data.html">Processing Dirty Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="expand_grid.html">Expand_grid : Create a dataframe from all combinations of inputs.</a></li>
<li class="toctree-l2"><a class="reference internal" href="french_trains.html">Processing French train data</a></li>
<li class="toctree-l2"><a class="reference internal" href="groupby_agg.html">Groupby_agg : Shortcut for assigning a groupby-transform to a new column.</a></li>
<li class="toctree-l2"><a class="reference internal" href="inflating_converting_currency.html">Inflating and Converting Currency</a></li>
<li class="toctree-l2"><a class="reference internal" href="medium_franchise.html">Tidy Up Web-Scraped Media Franchise Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="normalize.html">Normalization and Standardization</a></li>
<li class="toctree-l2"><a class="reference internal" href="sort_naturally.html">Using <code class="docutils literal notranslate"><span class="pre">sort_naturally</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="teacher_pupil.html">Processing International Teacher Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform_column.html">Transforming columns</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Contributors</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../notebooks.html">Examples</a><ul>
      <li>Previous: <a href="pyjanitor_intro.html" title="previous chapter">pyjanitor Usage Walkthrough</a></li>
      <li>Next: <a href="README.html" title="next chapter">Examples</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, PyJanitor devs.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/notebooks/Pivoting Data from Wide to Long.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>